import{aD as C,a as D,aE as Q}from"./admin.api.c4618457.js";import{l as F,_ as J,a as L}from"./Pagination.12ab80d4.js";import{r as s,o as d,g as w,w as o,c as S,y as O,F as P,a as n,e as t,b as x,m as B,f as N,t as E,N as V,i as T,j,C as A,k as R}from"./entry.95095313.js";import{b as q}from"./BaseUrl.ad8812f8.js";import{L as M}from"./Loading.5d2fac71.js";const U=["src"],G={class:"d-flex justify-end mr-4 mt-n5 gap-2"},H={class:"text-h6"},K={__name:"NotificationCard",props:{items:Array},emits:["delete-item"],setup(b,{emit:y}){const i=b,l=s([]),_=s(!1),v=async a=>{_.value=!0,await C({id:a}).then(h=>{l.value=i.items.filter(c=>c.id!==a),y("delete-item",l.value)})};return(a,h)=>{const c=V,I=n("FilePencilIcon"),f=n("v-avatar"),p=n("v-tooltip"),r=n("v-btn"),e=n("TrashIcon"),u=n("v-card-item"),g=n("v-card"),k=n("v-col"),$=n("v-row");return d(),w($,null,{default:o(()=>[(d(!0),S(P,null,O(i.items,(m,z)=>(d(),w(k,{cols:"12",lg:"3",sm:"6",key:z},{default:o(()=>[t(g,{elevation:"10",class:"withbg store__card",rounded:"md"},{default:o(()=>[t(c,{to:`/notifications/${m.id}`},{default:o(()=>[x("img",{crossorigin:"anonymous",src:`${B(q).url_base}/${m.preview}`,style:{height:"200px",width:"100%"},class:"rounded-t-md",alt:"123"},null,8,U)]),_:2},1032,["to"]),x("div",G,[t(r,{to:`/notifications/${m.id}`,size:"40",icon:"",class:"bg-primary d-flex"},{default:o(()=>[t(f,{size:"30",class:"text-white"},{default:o(()=>[t(I,{size:"15"})]),_:1}),t(p,{activator:"parent",location:"bottom"},{default:o(()=>[N("Duzet")]),_:1})]),_:2},1032,["to"]),t(r,{size:"40",icon:"",class:"bg-error d-flex",onClick:X=>v(m.id),loading:_.value},{default:o(()=>[t(f,{size:"30",class:"text-white"},{default:o(()=>[t(e,{size:"15"})]),_:1}),t(p,{activator:"parent",location:"bottom"},{default:o(()=>[N("Poz")]),_:1})]),_:2},1032,["onClick","loading"])]),t(u,{class:"pt-0 d-flex"},{default:o(()=>[x("h6",H,E(m.titleEn),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})}}},W={key:1},oe={__name:"index",setup(b){T();const y=j(),i=s(!1),l=s([]),_=s(0),v=JSON.parse(localStorage.getItem("notifyQuery"))||{page:1,eventId:""},a=s({page:v.page,limit:F,eventId:v.eventId}),h=e=>l.value=e,c=s([]),I=async()=>{const e=await D({limit:100});var u=[];u.push({name:"All",value:{eventId:""}});for(var g of e.data.data)u.push({name:g.name,value:{eventId:g.id}});c.value=u};A(y,e=>{localStorage.setItem("notifyQuery",JSON.stringify(a.value))},{deep:!0,immediate:!0});const f=e=>{e&&(a.value.page=1,a.value.eventId=e.eventId,localStorage.setItem("notifyQuery",JSON.stringify(a.value)),r())},p=e=>{e&&(a.value.page=e,localStorage.setItem("notifyQuery",JSON.stringify(a.value)),r())},r=async()=>{i.value=!0;const{data:e}=await Q(JSON.parse(localStorage.getItem("notifyQuery"))||a.value);l.value=e.data,_.value=e.count,i.value=!1};return R(async()=>{await I(),await r()}),(e,u)=>i.value?(d(),w(M,{key:0})):(d(),S("div",W,[t(J,{path:"/notifications/0",items:c.value,onFilter:f,"filter-visible":!0,"search-visible":!1},null,8,["items"]),t(K,{items:l.value,onDeleteItem:h},null,8,["items"]),t(L,{count:_.value,onSetPagination:p,page:a.value.page},null,8,["count","page"])]))}};export{oe as default};
