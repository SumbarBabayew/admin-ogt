import{b as h}from"./BaseUrl.ad8812f8.js";import{M as n}from"./MTextField.5144c562.js";import{bp as z,f as S,W as N}from"./admin.api.c4618457.js";import{i as L,j as T,r as f,k as F,g as M,c as R,e as a,w as o,a as i,o as w,b as p,f as J,t as P,m as x}from"./entry.95095313.js";import{L as q}from"./Loading.5d2fac71.js";import{J as G,l as H}from"./index.3e494a7b.js";import{f as D}from"./file-saver.3ee51bdb.js";/* empty css                       */const W={key:1,class:"mx-3"},Z={class:"d-flex align-center justify-space-between pt-sm-2"},K={class:"d-flex justify-end pb-3"},O=p("span",{class:"mr-2"},"Download image",-1),Q={class:"d-flex justify-end pb-3"},X=p("span",{class:"mr-2"},"Download files",-1),Y={class:"d-flex justify-end pb-3"},ee={class:"mr-2"},de={__name:"index",setup(le){const V=L(),d=T(),r=f(!1),b=f(!1),v=f(!1),e=f({firstName:null,lastName:null,position:null,email:null,phone:null,gender:null,birthDate:null,birthPlace:null,nationality:null,passportNumber:null,issueDate:null,expiryDate:null,education:null,homeAddress:null,visitPurpose:null,partnerPhone:null,companyCountry:null,photo:null,passports:null}),U=f([]),k=async()=>{const u=await S({limit:100});U.value=u.data},A=async()=>{if(d.params.id==0){if(!e.value.firstName||!e.value.lastName||!e.value.phone||!e.value.email||!e.value.position||!e.value.organisation)return r.value=!0;v.value=!0,await N({data:e.value,id:d.params.id}).then(async u=>{V.go(-1)}).catch(u=>{alert(u)})}else{if(!e.value.firstName||!e.value.lastName||!e.value.phone||!e.value.email||!e.value.position||!e.value.organisation)return r.value=!0;v.value=!0,await N({data:e.value,id:d.params.id}).then(async u=>{V.go(-1)}).catch(u=>{alert(u)})}};function B(u){return new Promise(function(l,c){H.getBinaryContent(u,function(m,g){m?c(m):l(g)})})}const C=async()=>{if(e.value.passports==null&&e.value.passports.length==0)return;const u=new G;e.value.passports.forEach(function(l,c){var m=l.split("/")[l.split("/").length-1];u.file(m,B(`${h.url_base}${l}`),{binary:!0})}),u.generateAsync({type:"blob"}).then(function(l){D.exports.saveAs(l,`delegate-${e.value.firstName} ${e.value.lastName}.zip`)})},$=()=>{let u=`${h.url_base}${e.value.photo.substring(1)}`;fetch(u).then(l=>l.blob()).then(l=>{D.exports.saveAs(l,`${e.value.firstName} ${e.value.lastName} ${e.value.photo.split("/")[e.value.photo.split("/").length-1]}`)}),console.log("downloading",u)};return F(async()=>{if(await k(),d.params.id!=0){b.value=!0;const{data:u}=await z({id:d.params.id});e.value=u,b.value=!1}}),(u,l)=>{const c=i("v-card-title"),m=i("ArrowBackUpIcon"),g=i("v-avatar"),y=i("v-btn"),s=i("v-col"),_=i("ScriptPlusIcon"),E=i("v-row"),I=i("v-card-item"),j=i("v-card");return b.value?(w(),M(q,{key:0})):(w(),R("div",W,[a(j,{elevation:"10",class:"withbg"},{default:o(()=>[a(I,null,{default:o(()=>[p("div",Z,[a(c,{class:"text-h5"},{default:o(()=>[J(P(x(d).params.id==0?"Add":"Edit")+" delegate",1)]),_:1}),a(y,{size:"large",icon:"",class:"bg-primary",onClick:l[0]||(l[0]=t=>x(V).go(-1))},{default:o(()=>[a(g,{size:"large",class:"text-white"},{default:o(()=>[a(m,{size:"25"})]),_:1})]),_:1})]),a(E,{class:"mt-3"},{default:o(()=>[a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Firstname",error:!e.value.firstName&&r.value,modelValue:e.value.firstName,"onUpdate:modelValue":l[1]||(l[1]=t=>e.value.firstName=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Lastname",error:!e.value.lastName&&r.value,modelValue:e.value.lastName,"onUpdate:modelValue":l[2]||(l[2]=t=>e.value.lastName=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Gender",error:!e.value.gender&&r.value,modelValue:e.value.gender,"onUpdate:modelValue":l[3]||(l[3]=t=>e.value.gender=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Position",error:!e.value.position&&r.value,modelValue:e.value.position,"onUpdate:modelValue":l[4]||(l[4]=t=>e.value.position=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Phone",error:!e.value.phone&&r.value,modelValue:e.value.phone,"onUpdate:modelValue":l[5]||(l[5]=t=>e.value.phone=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Email",error:!e.value.email&&r.value,modelValue:e.value.email,"onUpdate:modelValue":l[6]||(l[6]=t=>e.value.email=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Nationality",error:!e.value.nationality&&r.value,modelValue:e.value.nationality,"onUpdate:modelValue":l[7]||(l[7]=t=>e.value.nationality=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Birthday",error:!e.value.birthDate&&r.value,modelValue:e.value.birthDate,"onUpdate:modelValue":l[8]||(l[8]=t=>e.value.birthDate=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Birthplace",error:!e.value.birthPlace&&r.value,modelValue:e.value.birthPlace,"onUpdate:modelValue":l[9]||(l[9]=t=>e.value.birthPlace=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Country of company",error:!e.value.companyCountry&&r.value,modelValue:e.value.companyCountry,"onUpdate:modelValue":l[10]||(l[10]=t=>e.value.companyCountry=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Education",error:!e.value.education&&r.value,modelValue:e.value.education,"onUpdate:modelValue":l[11]||(l[11]=t=>e.value.education=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Visit purpose",error:!e.value.visitPurpose&&r.value,modelValue:e.value.visitPurpose,"onUpdate:modelValue":l[12]||(l[12]=t=>e.value.visitPurpose=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Passport number",error:!e.value.passportNumber&&r.value,modelValue:e.value.passportNumber,"onUpdate:modelValue":l[13]||(l[13]=t=>e.value.passportNumber=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Passport issued on",error:!e.value.issueDate&&r.value,modelValue:e.value.issueDate,"onUpdate:modelValue":l[14]||(l[14]=t=>e.value.issueDate=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Passport expire on",error:!e.value.expiryDate&&r.value,modelValue:e.value.expiryDate,"onUpdate:modelValue":l[15]||(l[15]=t=>e.value.expiryDate=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Full home addr",error:!e.value.homeAddress&&r.value,modelValue:e.value.homeAddress,"onUpdate:modelValue":l[16]||(l[16]=t=>e.value.homeAddress=t)},null,8,["error","modelValue"])]),_:1}),a(s,{cols:"6"},{default:o(()=>[a(n,{type:"text",label:"Local partner phone",error:!e.value.partnerPhone&&r.value,modelValue:e.value.partnerPhone,"onUpdate:modelValue":l[17]||(l[17]=t=>e.value.partnerPhone=t)},null,8,["error","modelValue"])]),_:1}),p("div",K,[a(y,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:$},{default:o(()=>[O,a(_)]),_:1},8,["loading"])]),p("div",Q,[a(y,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:C},{default:o(()=>[X,a(_)]),_:1},8,["loading"])])]),_:1})]),_:1}),p("div",Y,[a(y,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:A},{default:o(()=>[p("span",ee,P(x(d).params.id==0?"Add":"Edit")+" delegate ",1),a(_)]),_:1},8,["loading"])])]),_:1})]))}}};export{de as default};
