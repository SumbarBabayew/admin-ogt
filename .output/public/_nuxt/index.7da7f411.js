import{r,o as v,g as x,w as o,c as Q,y as L,F as q,a as l,e as t,b as S,m as N,z,f as C,t as V,N as j,j as E,C as G,k as T}from"./entry.95095313.js";import{am as A,a as M,an as R}from"./admin.api.c4618457.js";import{b as U}from"./BaseUrl.ad8812f8.js";import{L as H}from"./Loading.5d2fac71.js";import{l as $,_ as K,a as W}from"./Pagination.12ab80d4.js";const X=["src"],Y={class:"d-flex justify-end mt-n5"},Z=["textContent"],ee={__name:"GalleryCard",props:{items:Array},emits:["delete-item"],setup(b,{emit:_}){const n=b,i=r([]),s=r(!1),p=async u=>{s.value=!1,await A({id:u}).then(()=>{i.value=n.items.filter(d=>d.id!==u),_("delete-item",i.value)}),s.value=!1};return(u,d)=>{const a=j,I=l("DotsIcon"),h=l("v-btn"),k=l("FilePencilIcon"),g=l("v-list-item-title"),c=l("v-list-item"),e=l("v-list"),m=l("TrashIcon"),y=l("v-sheet"),D=l("v-menu"),J=l("v-card-item"),O=l("v-card"),P=l("v-col"),B=l("v-row");return v(),x(B,null,{default:o(()=>[(v(!0),Q(q,null,L(n.items,(f,F)=>(v(),x(P,{cols:"6",lg:"4",sm:"4",key:F},{default:o(()=>[t(O,{elevation:"10",class:"withbg store__card",rounded:"md"},{default:o(()=>[t(a,{to:""},{default:o(()=>[S("img",{crossorigin:"anonymous",src:`${N(U).url_base}/${f.cover}`,style:{height:"200px",width:"100%","object-fit":"cover"},class:"rounded-t-md",alt:"123"},null,8,X)]),_:2},1024),S("div",Y,[t(D,{"close-on-content-click":!1},{activator:o(({props:w})=>[t(h,z({size:"30",icon:"",class:"profileBtn bg-borderColor",variant:"text"},w),{default:o(()=>[t(I)]),_:2},1040)]),default:o(()=>[t(y,{rounded:"md",width:"200",elevation:"10",class:"mt-2"},{default:o(()=>[t(e,{class:"py-0",lines:"one",density:"compact",onClick:w=>u.$goPage(`/gallery/${f.id}`,{})},{default:o(()=>[t(c,{value:"item2","active-color":"primary"},{prepend:o(()=>[t(k,{size:"20"})]),default:o(()=>[t(g,{class:"pl-4 text-body-1"},{default:o(()=>[C("Edit")]),_:1})]),_:1})]),_:2},1032,["onClick"]),t(e,{class:"py-0",lines:"one",density:"compact",loading:N(s),onClick:w=>p(f.id)},{default:o(()=>[t(c,{value:"item2","active-color":"primary"},{prepend:o(()=>[t(m,{size:"20"})]),default:o(()=>[t(g,{class:"pl-4 text-body-1"},{default:o(()=>[C("Delete")]),_:1})]),_:1})]),_:2},1032,["loading","onClick"])]),_:2},1024)]),_:2},1024)]),t(J,{class:"pt-0 d-flex"},{default:o(()=>[S("h6",{class:"text-h6",textContent:V(`${f.title}`)},null,8,Z)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})}}},te={key:1},ce={__name:"index",setup(b){const _=r(!1),n=E(),i=r([]),s=r(0),p=r([]),u=async()=>{const e=await M({limit:100});var m=[];m.push({name:"All",value:{eventId:""}});for(var y of e.data.data)m.push({name:y.name,value:{eventId:y.id}});p.value=m},d=JSON.parse(localStorage.getItem("galleryQuery"))||{page:1,keyword:"",categoryId:n.query.categoryId||"",eventId:""},a=r({page:d.page,keyword:d.keyword,limit:$,eventId:d.eventId}),I=e=>i.value=e;G(n,e=>{n.query.categoryId&&(a.value.categoryId=n.query.categoryId),localStorage.setItem("galleryQuery",JSON.stringify(a.value))},{deep:!0,immediate:!0});const h=e=>{e&&(a.value.keyword="",a.value.page=1,a.value.eventId=e.eventId,localStorage.setItem("galleryQuery",JSON.stringify(a.value)),c())},k=e=>{e&&(a.value.keyword=e,a.value.page=1,localStorage.setItem("galleryQuery",JSON.stringify(a.value)),c())},g=e=>{e&&(a.value.page=e,localStorage.setItem("galleryQuery",JSON.stringify(a.value)),c())},c=async()=>{_.value=!0;const{data:e}=await R(JSON.parse(localStorage.getItem("galleryQuery"))||a.value);i.value=e.data,s.value=e.count,_.value=!1};return T(async()=>{await c(),await u(),Math.ceil(s.value/$)==0&&(a.value.page=1,localStorage.setItem("galleryQuery",JSON.stringify(a.value)))}),(e,m)=>_.value?(v(),x(H,{key:0})):(v(),Q("div",te,[t(K,{path:"/gallery/0",items:p.value,onFilter:h,onSearch:k},null,8,["items"]),t(ee,{items:i.value,onDeleteItem:I},null,8,["items"]),t(W,{count:s.value,onSetPagination:g,page:a.value.page},null,8,["count","page"])]))}};export{ce as default};
