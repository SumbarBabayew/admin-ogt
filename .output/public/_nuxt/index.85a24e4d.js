import{b as w}from"./BaseUrl.ad8812f8.js";import{M as u}from"./MTextField.5144c562.js";import{V as I,f as j,W as N}from"./admin.api.c4618457.js";import{i as z,j as S,r as c,k as L,g as M,c as J,e as l,w as o,a as i,o as U,b as p,f as O,t as h,m as x}from"./entry.95095313.js";import{L as R}from"./Loading.5d2fac71.js";import{J as W,l as H}from"./index.3e494a7b.js";import{f as k}from"./file-saver.3ee51bdb.js";/* empty css                       */const Z={key:1,class:"mx-3"},q={class:"d-flex align-center justify-space-between pt-sm-2"},G={class:"d-flex justify-end pb-3"},K=p("span",{class:"mr-2"},"Download image",-1),Q={class:"d-flex justify-end pb-3"},X=p("span",{class:"mr-2"},"Download files",-1),Y={class:"d-flex justify-end pb-3"},ee={class:"mr-2"},de={__name:"index",setup(ae){const _=z(),d=S(),s=c(!1),y=c(!1),v=c(!1),e=c({firstName:null,lastName:null,position:null,email:null,phone:null,country:null,organisation:null,website:null,legalAddress:null,orgCountry:null,orgDescription:null,participationType:null,participationFormat:null,photo:null,passports:null}),A=c([]),D=async()=>{const r=await j({limit:100});A.value=r.data},B=async()=>{if(d.params.id==0){if(!e.value.firstName||!e.value.lastName||!e.value.phone||!e.value.email||!e.value.position||!e.value.organisation)return s.value=!0;v.value=!0,await N({data:e.value,id:d.params.id}).then(async r=>{_.go(-1)}).catch(r=>{alert(r)})}else{if(!e.value.firstName||!e.value.lastName||!e.value.phone||!e.value.email||!e.value.position||!e.value.organisation)return s.value=!0;v.value=!0,await N({data:e.value,id:d.params.id}).then(async r=>{_.go(-1)}).catch(r=>{alert(r)})}};function $(r){return new Promise(function(a,f){H.getBinaryContent(r,function(m,V){m?f(m):a(V)})})}const C=async()=>{if(e.value.passports==null&&e.value.passports.length==0)return;const r=new W;e.value.passports.forEach(function(a,f){var m=a.split("/")[a.split("/").length-1];r.file(m,$(`${w.url_base}${a}`),{binary:!0})}),r.generateAsync({type:"blob"}).then(function(a){k.exports.saveAs(a,`delegate-${e.value.firstName} ${e.value.lastName}.zip`)})},T=()=>{let r=`${w.url_base}${e.value.photo.substring(1)}`;fetch(r).then(a=>a.blob()).then(a=>{k.exports.saveAs(a,`${e.value.firstName} ${e.value.lastName} ${e.value.photo.split("/")[e.value.photo.split("/").length-1]}`)}),console.log("downloading",r)};return L(async()=>{if(await D(),d.params.id!=0){y.value=!0;const{data:r}=await I({id:d.params.id});e.value=r,y.value=!1}}),(r,a)=>{const f=i("v-card-title"),m=i("ArrowBackUpIcon"),V=i("v-avatar"),g=i("v-btn"),n=i("v-col"),b=i("ScriptPlusIcon"),P=i("v-row"),F=i("v-card-item"),E=i("v-card");return y.value?(U(),M(R,{key:0})):(U(),J("div",Z,[l(E,{elevation:"10",class:"withbg"},{default:o(()=>[l(F,null,{default:o(()=>[p("div",q,[l(f,{class:"text-h5"},{default:o(()=>[O(h(x(d).params.id==0?"Add":"Edit")+" delegate",1)]),_:1}),l(g,{size:"large",icon:"",class:"bg-primary",onClick:a[0]||(a[0]=t=>x(_).go(-1))},{default:o(()=>[l(V,{size:"large",class:"text-white"},{default:o(()=>[l(m,{size:"25"})]),_:1})]),_:1})]),l(P,{class:"mt-3"},{default:o(()=>[l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Firstname",error:!e.value.firstName&&s.value,modelValue:e.value.firstName,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.firstName=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Lastname",error:!e.value.lastName&&s.value,modelValue:e.value.lastName,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.lastName=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Position",error:!e.value.position&&s.value,modelValue:e.value.position,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.position=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Phone",error:!e.value.phone&&s.value,modelValue:e.value.phone,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.phone=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Email",error:!e.value.email&&s.value,modelValue:e.value.email,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.email=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Country",error:!e.value.country&&s.value,modelValue:e.value.country,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.country=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Organisation",error:!e.value.organisation&&s.value,modelValue:e.value.organisation,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.organisation=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Legal address",error:!e.value.legalAddress&&s.value,modelValue:e.value.legalAddress,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.legalAddress=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Organisation description",error:!e.value.orgDescription&&s.value,modelValue:e.value.orgDescription,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value.orgDescription=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Website",error:!e.value.website&&s.value,modelValue:e.value.website,"onUpdate:modelValue":a[10]||(a[10]=t=>e.value.website=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Participation Type",error:!e.value.participationType&&s.value,modelValue:e.value.participationType,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value.participationType=t)},null,8,["error","modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(u,{type:"text",label:"Participation Format",error:!e.value.participationFormat&&s.value,modelValue:e.value.participationFormat,"onUpdate:modelValue":a[12]||(a[12]=t=>e.value.participationFormat=t)},null,8,["error","modelValue"])]),_:1}),p("div",G,[l(g,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:T},{default:o(()=>[K,l(b)]),_:1},8,["loading"])]),p("div",Q,[l(g,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:C},{default:o(()=>[X,l(b)]),_:1},8,["loading"])])]),_:1})]),_:1}),p("div",Y,[l(g,{class:"profileBtn bg-primary custom-hover-primary",variant:"text",loading:v.value,onClick:B},{default:o(()=>[p("span",ee,h(x(d).params.id==0?"Add":"Edit")+" delegate ",1),l(b)]),_:1},8,["loading"])])]),_:1})]))}}};export{de as default};
